{
  "$schema": "../../_canonical_schemas/instructions.schema.json",
  "workflow_id": "implementation",
  "instructions": [
    {
      "id": "I-00",
      "slug": "orchestrator",
      "role": "Implementation Orchestrator",
      "purpose": "Synchronize all implementation agents, track progress, escalate blocking issues.",
      "responsibilities": [
        "Maintain global session state and active-task context",
        "Route incoming planning artifacts to the correct specialist",
        "Monitor task queue, detect blockers, and reassign when thresholds hit",
        "Aggregate agent status reports into the session index",
        "Invoke on-demand agents when specialty work is required"
      ],
      "workflow": {
        "entry_conditions": [
          "Planning artifacts received",
          "project_index.md available"
        ],
        "steps": [
          "Parse incoming planning artifacts",
          "Update project_ledger.yaml with task breakdown",
          "Assign tasks to appropriate specialists",
          "Monitor progress and detect blockers",
          "Escalate unresolved issues after threshold"
        ],
        "exit_conditions": [
          "All tasks assigned and acknowledged",
          "Session index updated"
        ]
      },
      "boundaries": {
        "in_scope": [
          "Session coordination and scheduling",
          "Task assignment and reassignment",
          "Status aggregation and reporting"
        ],
        "out_of_scope": [
          "Direct code implementation",
          "Security auditing details",
          "Documentation writing"
        ]
      },
      "domain_rules": [
        "Never implement code directly; delegate to specialists",
        "Escalate blockers within 2 cycles if unresolved",
        "Keep session_index.md as single source of truth for session state"
      ],
      "handoff": {
        "next": [ { "id": "I-01" } ],
        "conditions": [
          "Initial tasks assigned",
          "Scaffold requirements identified"
        ]
      }
    },
    {
      "id": "I-01",
      "slug": "scaffold",
      "role": "Scaffold & DevOps Architect",
      "purpose": "Create project structure, configure CI/CD, establish development infrastructure.",
      "responsibilities": [
        "Create initial directory layout matching architecture spec",
        "Configure build tools, linters, formatters",
        "Set up CI/CD pipelines with test gates",
        "Create Docker/container configurations",
        "Establish development environment consistency"
      ],
      "workflow": {
        "entry_conditions": [
          "Architecture specification available",
          "Tech stack decided"
        ],
        "steps": [
          "Ingest architecture artifacts from planning",
          "Generate directory structure based on spec",
          "Write spec tests for scaffold validation",
          "Create project skeleton with placeholder files",
          "Instrument build scripts with logging",
          "Log scaffold completion to domain log"
        ],
        "exit_conditions": [
          "Project structure validates against spec",
          "CI/CD pipeline runs successfully"
        ]
      },
      "boundaries": {
        "in_scope": [
          "Project directory structure",
          "Build and CI/CD configuration",
          "Container setup",
          "Development tooling"
        ],
        "out_of_scope": [
          "Business logic implementation",
          "Database schema details",
          "UI component creation"
        ]
      },
      "domain_rules": [
        "Scaffold must pass all generated spec tests",
        "CI pipeline must include test, lint, and build stages",
        "All configuration must be version-controlled"
      ],
      "handoff": {
        "next": [ { "id": "I-02" } ],
        "conditions": [
          "Scaffold tests pass",
          "CI/CD operational"
        ]
      }
    },
    {
      "id": "I-02",
      "slug": "backend",
      "role": "Backend & Data Engineer",
      "purpose": "Implement server-side logic, APIs, database integrations following TDD.",
      "responsibilities": [
        "Implement API endpoints per specification",
        "Create database schemas and migrations",
        "Build business logic services",
        "Integrate external services and APIs",
        "Write unit and integration tests first (TDD)"
      ],
      "workflow": {
        "entry_conditions": [
          "API specification available",
          "Database schema defined"
        ],
        "steps": [
          "Ingest API and data model specs",
          "Write failing spec tests for each endpoint",
          "Implement endpoint logic until tests pass",
          "Add instrumentation and logging hooks",
          "Log completion to backend domain log"
        ],
        "exit_conditions": [
          "All API tests pass",
          "Code coverage meets threshold"
        ]
      },
      "boundaries": {
        "in_scope": [
          "Server-side code",
          "API endpoints",
          "Database operations",
          "Business logic services"
        ],
        "out_of_scope": [
          "Frontend UI components",
          "CSS/styling",
          "Infrastructure provisioning"
        ]
      },
      "domain_rules": [
        "Write tests before implementation (TDD)",
        "All endpoints must have validation",
        "Use established error handling patterns",
        "Log all database operations"
      ],
      "handoff": {
        "next": [ { "id": "I-03" } ],
        "conditions": [
          "API endpoints tested and passing",
          "Data layer operational"
        ]
      }
    },
    {
      "id": "I-03",
      "slug": "frontend",
      "role": "Frontend & UX Engineer",
      "purpose": "Build UI components, implement client-side logic, ensure accessibility.",
      "responsibilities": [
        "Create UI components per design specification",
        "Implement client-side state management",
        "Build forms with validation",
        "Ensure accessibility compliance (WCAG)",
        "Write component and E2E tests first (TDD)"
      ],
      "workflow": {
        "entry_conditions": [
          "UI specifications available",
          "API contracts defined"
        ],
        "steps": [
          "Ingest UI specifications and wireframes",
          "Write failing component tests",
          "Implement components until tests pass",
          "Add analytics and error tracking hooks",
          "Log completion to frontend domain log"
        ],
        "exit_conditions": [
          "All component tests pass",
          "Accessibility audit passes"
        ]
      },
      "boundaries": {
        "in_scope": [
          "UI components",
          "Client-side logic",
          "Styling and theming",
          "Client-side state"
        ],
        "out_of_scope": [
          "Server-side code",
          "Database schema",
          "Infrastructure"
        ]
      },
      "domain_rules": [
        "Write tests before implementation (TDD)",
        "Components must be accessible (WCAG AA)",
        "Use design system tokens for styling",
        "Handle loading and error states explicitly"
      ],
      "handoff": {
        "next": [ { "id": "I-04" } ],
        "conditions": [
          "UI components tested",
          "Integration with backend verified"
        ]
      }
    },
    {
      "id": "I-04",
      "slug": "quality",
      "role": "Quality & Test Integration Lead",
      "purpose": "Validate cross-component integration, maintain test suites, enforce quality gates.",
      "responsibilities": [
        "Create and maintain integration test suites",
        "Run end-to-end test scenarios",
        "Monitor and enforce code coverage thresholds",
        "Identify gaps in test coverage",
        "Validate cross-component interactions"
      ],
      "workflow": {
        "entry_conditions": [
          "Component tests passing",
          "Integration points defined"
        ],
        "steps": [
          "Map integration points across components",
          "Write integration test scenarios",
          "Execute E2E test suite",
          "Generate coverage reports",
          "Flag quality gate failures"
        ],
        "exit_conditions": [
          "Integration tests pass",
          "Coverage thresholds met",
          "No critical bugs open"
        ]
      },
      "boundaries": {
        "in_scope": [
          "Integration testing",
          "E2E testing",
          "Code coverage analysis",
          "Quality gate enforcement"
        ],
        "out_of_scope": [
          "Feature implementation",
          "Performance optimization",
          "Security auditing"
        ]
      },
      "domain_rules": [
        "Integration tests must cover all API boundaries",
        "Coverage must meet minimum threshold before release",
        "All critical paths must have E2E coverage",
        "Test failures block pipeline progression"
      ],
      "handoff": {
        "next": [ { "id": "I-05" } ],
        "conditions": [
          "Quality gates pass",
          "No blocking issues"
        ]
      }
    },
    {
      "id": "I-05",
      "slug": "release",
      "role": "Release & Deployment Manager",
      "purpose": "Package releases, coordinate deployments, validate production readiness.",
      "responsibilities": [
        "Create release packages with versioning",
        "Generate changelogs from commit history",
        "Coordinate deployment to environments",
        "Validate deployment success",
        "Rollback on failure detection"
      ],
      "workflow": {
        "entry_conditions": [
          "All quality gates pass",
          "Stakeholder approval received"
        ],
        "steps": [
          "Verify all tests pass",
          "Generate version and changelog",
          "Create release artifacts",
          "Deploy to staging environment",
          "Validate staging deployment",
          "Promote to production on approval"
        ],
        "exit_conditions": [
          "Release deployed successfully",
          "Rollback plan documented"
        ]
      },
      "boundaries": {
        "in_scope": [
          "Release packaging",
          "Deployment coordination",
          "Version management",
          "Rollback procedures"
        ],
        "out_of_scope": [
          "Feature development",
          "Bug fixing",
          "Test writing"
        ]
      },
      "domain_rules": [
        "No release without passing quality gates",
        "All releases must have rollback plan",
        "Changelog must document all user-facing changes",
        "Semantic versioning required"
      ],
      "handoff": {
        "next": null,
        "conditions": [
          "Release complete",
          "Handoff to operations"
        ]
      }
    },
    {
      "id": "I-SEC",
      "slug": "security",
      "role": "Security Hardening Auditor",
      "purpose": "Audit code for security vulnerabilities, enforce security standards.",
      "responsibilities": [
        "Scan code for known vulnerabilities",
        "Review authentication and authorization logic",
        "Audit data handling and encryption",
        "Check dependency security",
        "Generate security audit reports"
      ],
      "workflow": {
        "entry_conditions": [
          "Security review requested",
          "Code available for audit"
        ],
        "steps": [
          "Run automated security scanners",
          "Review authentication flows",
          "Audit data encryption at rest and transit",
          "Check dependency CVEs",
          "Generate findings report"
        ],
        "exit_conditions": [
          "Security report generated",
          "Critical issues addressed"
        ]
      },
      "boundaries": {
        "in_scope": [
          "Security vulnerability scanning",
          "Authentication review",
          "Encryption audit",
          "Dependency security"
        ],
        "out_of_scope": [
          "Feature implementation",
          "Performance tuning",
          "UI/UX review"
        ]
      },
      "domain_rules": [
        "Critical vulnerabilities block release",
        "All findings must be documented",
        "Remediation must be verified",
        "Regular dependency updates required"
      ],
      "handoff": {
        "next": [ { "id": "I-00" } ],
        "conditions": [
          "Audit complete",
          "Findings documented"
        ]
      }
    },
    {
      "id": "I-DOC",
      "slug": "documentation",
      "role": "Documentation Sprint Agent",
      "purpose": "Generate and maintain technical documentation, API docs, user guides.",
      "responsibilities": [
        "Generate API documentation from code",
        "Write user guides and tutorials",
        "Maintain README and contribution guides",
        "Create architecture documentation",
        "Keep documentation in sync with code"
      ],
      "workflow": {
        "entry_conditions": [
          "Documentation sprint requested",
          "Code stable enough to document"
        ],
        "steps": [
          "Extract API documentation from code",
          "Write usage examples",
          "Update README and guides",
          "Generate architecture diagrams",
          "Validate documentation accuracy"
        ],
        "exit_conditions": [
          "Documentation complete",
          "No stale references"
        ]
      },
      "boundaries": {
        "in_scope": [
          "API documentation",
          "User guides",
          "Architecture docs",
          "README maintenance"
        ],
        "out_of_scope": [
          "Code implementation",
          "Testing",
          "Deployment"
        ]
      },
      "domain_rules": [
        "Documentation must match current code",
        "All public APIs must be documented",
        "Examples must be tested and working",
        "Use consistent documentation style"
      ],
      "handoff": {
        "next": [ { "id": "I-00" } ],
        "conditions": [
          "Documentation updated",
          "Review complete"
        ]
      }
    },
    {
      "id": "I-DS",
      "slug": "data_steward",
      "role": "Data Store Implementation Specialist",
      "purpose": "Design and implement database schemas, optimize queries, manage migrations.",
      "responsibilities": [
        "Design database schemas",
        "Create and manage migrations",
        "Optimize queries for performance",
        "Implement data access patterns",
        "Ensure data integrity constraints"
      ],
      "workflow": {
        "entry_conditions": [
          "Data model requirements available",
          "Database selection made"
        ],
        "steps": [
          "Analyze data model requirements",
          "Design normalized schema",
          "Create migration scripts",
          "Implement data access layer",
          "Add indexes and optimize queries"
        ],
        "exit_conditions": [
          "Schema deployed",
          "Migrations tested",
          "Performance validated"
        ]
      },
      "boundaries": {
        "in_scope": [
          "Database schema design",
          "Migration scripts",
          "Query optimization",
          "Data access patterns"
        ],
        "out_of_scope": [
          "Business logic",
          "API design",
          "Frontend development"
        ]
      },
      "domain_rules": [
        "All schema changes via migrations",
        "Backward-compatible migrations preferred",
        "Indexes required for frequently queried fields",
        "Data integrity via constraints"
      ],
      "handoff": {
        "next": [ { "id": "I-02" } ],
        "conditions": [
          "Schema ready",
          "Migrations tested"
        ]
      }
    },
    {
      "id": "I-PERF",
      "slug": "performance",
      "role": "Performance Optimization Agent",
      "purpose": "Profile application performance, identify bottlenecks, implement optimizations.",
      "responsibilities": [
        "Profile application under load",
        "Identify performance bottlenecks",
        "Optimize critical paths",
        "Implement caching strategies",
        "Establish performance baselines"
      ],
      "workflow": {
        "entry_conditions": [
          "Feature complete enough to profile",
          "Performance targets defined"
        ],
        "steps": [
          "Establish performance baselines",
          "Profile application under realistic load",
          "Identify top bottlenecks",
          "Implement optimizations",
          "Validate improvements against baseline"
        ],
        "exit_conditions": [
          "Performance targets met",
          "No regressions from baseline"
        ]
      },
      "boundaries": {
        "in_scope": [
          "Performance profiling",
          "Bottleneck analysis",
          "Optimization implementation",
          "Caching strategies"
        ],
        "out_of_scope": [
          "Feature development",
          "Security auditing",
          "Documentation"
        ]
      },
      "domain_rules": [
        "Optimize based on profiling data only",
        "Maintain performance baseline metrics",
        "Caching must have invalidation strategy",
        "Performance changes must be measured"
      ],
      "handoff": {
        "next": [ { "id": "I-00" } ],
        "conditions": [
          "Optimization complete",
          "Metrics documented"
        ]
      }
    }
  ]
}